webpackJsonp([0xd25cd0df9ab0],{498:function(n,a){n.exports={data:{site:{siteMetadata:{title:"To kill a mocking bug",subtitle:"Unearthing curious .NET behaviour",author:{name:"Jeroen Vannevel",twitter:"VannevelJeroen"},disqusShortname:"",url:"https://vannevel.net"}},markdownRemark:{id:"/home/runner/work/vannevel.net/vannevel.net/src/pages/articles/2020-07-12---Executing-Commands-In-Terminal-From-Swift/index.md absPath of file >>> MarkdownRemark",html:'<p>I’ve been working on a little MacOS app which is supposed to spawn a Terminal and execute commands in it. As I was digging through <code class="language-text">Process</code> and <code class="language-text">NSTask</code> I wasn’t able to find a way to do both of these actions. However through some embedded AppleScript, you <em>can</em> get it to work.</p>\n<p>The below code will achieve exactly that:</p>\n<div class="gatsby-highlight">\n      <pre class="language-swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function">execute</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> script <span class="token operator">=</span> <span class="token string">""</span>"\ntell application \\"<span class="token builtin">Terminal</span>\\"\n    <span class="token keyword">do</span> script <span class="token string">"<span class="token interpolation"><span class="token delimiter variable">\\(</span>command<span class="token delimiter variable">)</span></span>"</span>\nend tell\n<span class="token string">""</span>"\n    <span class="token keyword">var</span> error<span class="token punctuation">:</span> <span class="token builtin">NSDictionary</span><span class="token operator">?</span>\n    <span class="token keyword">if</span> <span class="token keyword">let</span> scriptObject <span class="token operator">=</span> <span class="token function">NSAppleScript</span><span class="token punctuation">(</span>source<span class="token punctuation">:</span> script<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> output <span class="token operator">=</span> scriptObject<span class="token punctuation">.</span><span class="token function">executeAndReturnError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>error<span class="token punctuation">)</span>\n        \n        <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token constant">nil</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"error: <span class="token interpolation"><span class="token delimiter variable">\\(</span><span class="token function">String</span><span class="token punctuation">(</span>describing<span class="token punctuation">:</span> error<span class="token punctuation">)</span><span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"output: <span class="token interpolation"><span class="token delimiter variable">\\(</span><span class="token function">String</span><span class="token punctuation">(</span>describing<span class="token punctuation">:</span> output<span class="token punctuation">.</span>stringValue<span class="token punctuation">)</span><span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>If you now execute this, you’ll see an error similar to this in your console:</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">error: Optional({\n    NSAppleScriptErrorAppName = Terminal;\n    NSAppleScriptErrorBriefMessage = &quot;Not authorized to send Apple events to Terminal.&quot;;\n    NSAppleScriptErrorMessage = &quot;Not authorized to send Apple events to Terminal.&quot;;\n    NSAppleScriptErrorNumber = &quot;-1743&quot;;\n    NSAppleScriptErrorRange = &quot;NSRange: {26, 55}&quot;;\n})</code></pre>\n      </div>\n<p>In order to grant these permissions, add the following to your info.plist:</p>\n<div class="gatsby-highlight">\n      <pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">></span></span>NSAppleEventsUsageDescription<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>key</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">></span></span>hello jeroen<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">></span></span></code></pre>\n      </div>\n<p>If you now trigger this behaviour again, you’ll be prompted with the following popup:</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/permissions-36a63114a7d1cc83049229adbafb981d-8aed6.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 884px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABW0lEQVQoz4VSy26CUBTkz7tuojsX7a6LfoELiS58G0U0ulBjig8uCERB8A+mzDGXELXpYnKeM3e4FyOOY3ieV8D3fYHOy/3y3qv9NE1huK6Lw+EApVx4Skm+3+/B/l9Q+Z7OuUvOXUPB8P0Tbrcb3CCCo+75arVCv9/HcDjEYDCAZVmYTqdS27aN8Xhc9JbLJTabjfBE8JTbdfPk7b2C2tc3gjASUr1eR6vVgmma6HQ6EtljZL/RaEhcr9cIggDX61VcGvoOKtUqah+f+NntYE0mQm42m0Kk23a7jV6vJ4Ldbldq5nTNdygEaZNFlmX54IIkSTCbzYQwyYVJXiwWiKJIQDdEGIYSL5c750lQD3gaL3q73cJxHKm1A01kLIPcQpDPrYXKS1qIOd1rIZL5exB8CD1nXjgk8Xw+y/Ij2Of8sdaHPX0yP4uvOhqN5IL/w6s99ubzOY7HI34BVn/GEqaIPpEAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Permission request for Terminal interaction"\n        title=""\n        src="/static/permissions-36a63114a7d1cc83049229adbafb981d-8aed6.png"\n        srcset="/static/permissions-36a63114a7d1cc83049229adbafb981d-1501c.png 240w,\n/static/permissions-36a63114a7d1cc83049229adbafb981d-740c7.png 480w,\n/static/permissions-36a63114a7d1cc83049229adbafb981d-8aed6.png 884w"\n        sizes="(max-width: 884px) 100vw, 884px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Note that this will only work if you don’t have Sandbox enabled. In order to disable the Sandbox, delete your .entitlements file.</p>',fields:{tagSlugs:["/tags/swift/","/tags/apple-script/","/tags/terminal/"]},frontmatter:{title:"Executing commands in the Terminal from Swift",tags:["Swift","AppleScript","Terminal"],date:"2020-07-12T20:00:00.000Z",description:"How can you open a new Terminal and execute commands from a Swift app?"}}},pathContext:{slug:"/posts/executing-commands-in-terminal-from-swift"}}}});
//# sourceMappingURL=path---posts-executing-commands-in-terminal-from-swift-438599b03a6ce8de42fe.js.map